<UserControl x:Class="PlotterControl.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">
    <ScrollViewer Margin="10" VerticalScrollBarVisibility="Auto">
        <StackPanel MaxWidth="600" HorizontalAlignment="Left">
            <!-- Machine Dimensions -->
            <materialDesign:Card Padding="16" Margin="0,0,0,8">
                <StackPanel>
                    <TextBlock Text="Machine Dimensions" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="Bed Preset:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <ComboBox ItemsSource="{Binding BedPresets}" SelectedItem="{Binding SelectedBedPreset}"
                                  DisplayMemberPath="Name" Width="200"
                                  Style="{StaticResource MaterialDesignFilledComboBox}"/>
                    </StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding EditableConfig.XMaxMM}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="X Max (mm)"/>
                        <TextBox Grid.Column="2" Text="{Binding EditableConfig.YMaxMM}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Y Max (mm)"/>
                        <TextBox Grid.Column="4" Text="{Binding EditableConfig.ZMaxMM}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Z Max (mm)"/>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- Pen Settings -->
            <materialDesign:Card Padding="16" Margin="0,0,0,8">
                <StackPanel>
                    <TextBlock Text="Pen Settings" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding EditableConfig.PenUpZ}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Pen Up Z (mm)"/>
                        <TextBox Grid.Column="2" Text="{Binding EditableConfig.PenDownZ}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Pen Down Z (mm)"/>
                    </Grid>
                    <Grid Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding EditableConfig.PenTipSizeMM}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Pen Tip Size (mm)"/>
                        <TextBox Grid.Column="2" Text="{Binding EditableConfig.PenPressureMM}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Pen Pressure (mm)"/>
                    </Grid>
                    <TextBlock Text="Tip: 0.3=fine, 0.5=standard, 1.0=bold. Pressure: 0.0=light, 0.1=normal, 0.4=heavy."
                               FontSize="11" Opacity="0.6" TextWrapping="Wrap" Margin="0,4,0,0"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Speed Settings -->
            <materialDesign:Card Padding="16" Margin="0,0,0,8">
                <StackPanel>
                    <TextBlock Text="Speed Settings (mm/min)" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding EditableConfig.RapidFeedrate}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Rapid Feedrate"/>
                        <TextBox Grid.Column="2" Text="{Binding EditableConfig.DrawFeedrate}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Draw Feedrate"/>
                        <TextBox Grid.Column="4" Text="{Binding EditableConfig.ZFeedrate}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Z Feedrate"/>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- Communication -->
            <materialDesign:Card Padding="16" Margin="0,0,0,8">
                <StackPanel>
                    <TextBlock Text="Communication" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" Text="{Binding EditableConfig.BaudRate}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Baud Rate"/>
                        <TextBox Grid.Column="2" Text="{Binding EditableConfig.CommandTimeout}"
                                 Style="{StaticResource MaterialDesignFilledTextBox}"
                                 materialDesign:HintAssist.Hint="Timeout (ms)"/>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- UI Settings -->
            <materialDesign:Card Padding="16" Margin="0,0,0,8">
                <StackPanel>
                    <TextBlock Text="UI Settings" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal" Margin="0,2,0,8">
                        <TextBlock Text="Dark Theme" VerticalAlignment="Center" Margin="0,0,12,0"/>
                        <ToggleButton IsChecked="{Binding IsDarkTheme}"
                                      Style="{StaticResource MaterialDesignSwitchToggleButton}"/>
                    </StackPanel>
                    <CheckBox Content="Show Grid in Preview" IsChecked="{Binding EditableConfig.ShowGrid}" Margin="0,2"
                              Style="{StaticResource MaterialDesignCheckBox}"/>
                    <CheckBox Content="Auto Connect on Startup" IsChecked="{Binding EditableConfig.AutoConnect}" Margin="0,2"
                              Style="{StaticResource MaterialDesignCheckBox}"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Save & Config Management -->
            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                <Button Command="{Binding SaveSettingsCommand}" Content="Save Settings" Margin="0,0,8,0"
                        Style="{StaticResource MaterialDesignRaisedButton}"/>
                <Button Command="{Binding ExportConfigCommand}" Content="Export" Margin="0,0,4,0"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        ToolTip="Export configuration to JSON file"/>
                <Button Command="{Binding ImportConfigCommand}" Content="Import" Margin="0,0,8,0"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        ToolTip="Import configuration from JSON file"/>
                <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" Margin="4,0,0,0"
                           Foreground="{DynamicResource MaterialDesign.Brush.Primary}" FontSize="12"/>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>
